<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
.MsoChpDefault
	{font-size:12.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-CA link=blue vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><span lang=EN-US style='font-size:24.0pt;font-family:"Arial",sans-serif'>S3/Blob
Manipulation </span><span lang=EN style='font-family:"Arial",sans-serif'>(version
1.0)</span></p>

<p class=MsoNormal><span lang=EN style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif;color:#404040'>Cloud
Service Label:  IaaS, PaaS</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt'><b><span lang=EN-US
style='font-size:14.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-top:6.0pt'><span lang=EN-US style='font-size:
16.0pt;font-family:"Arial",sans-serif'>Description</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>By
default S3/Blobs are accessible from the public internet if the S3/blob
identifier is known and you have the proper credentials.  Given this, an
adversary with stolen storage credentials can read from existing buckets from
anywhere on the Internet and exfiltrate the data stored on them.  Malicious
actors with more expansive cloud access can stage collected data from other
cloud assets within a bucket and then remove contents from the bucket to any
external host. They can be also serve out content via HTTPS to allow public
consumption of new code.</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>Although
often intended as a temporary solution while working on more challenging
aspects of code development, storing code in cloud storage can unintentionally
be incorporated into production, leaving consumers of this software vulnerable
to code modification when a container or bucket is misconfigured. Adversaries
can modify code stored in buckets to implant backdoor software to gain a
foothold in what would otherwise be a well-protected enclave.  If a storage
bucket used for hosting code is ever deleted in the future, adversaries can
reclaim the bucket name and without any special privileges stage code for
unsuspecting people to invoke. This is especially problematic if web servers
are pointing at the repo to fetch some forgotten piece of code.   </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Examples</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Name</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Capitol
  One Data Breach</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Using previously obtained credentials attackers accessed
  sensitive data stored within S3 buckets and exfiltrated it.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Hackerone</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-right:.1in'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>The
  Rocket Chat install application was grabbing code from a publicly accessible
  S3 bucket. When the S3 bucket was deleted, this made the situation even
  worse.  Once a bucket is deleted, anyone with access to AWS can create a
  bucket of the same name. In this case putting a malicious script within the
  bucket and waiting for unsuspecting users of the Rocket Chat installation
  script to fetch and run their payload.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Subjack</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Open source tool that automates the search for s3 buckets and
  other cloud resources that are registered in DNS but which no longer exist
  indicating a possible hijacking opportunity.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Scout
  Suite</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Scout Suite is an open source multi-cloud security tool that
  will check exposed storage APIs for misconfigurations and risks. The tool is
  compatible with cloud providers like AWS, Azure, GCP, and Alpha versions for
  Alibaba Cloud and Oracle Cloud Infrastructure.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Prowler</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Prowler is open source tool on GitHub checks security best
  practices against AWS CIS Benchmark standards. This includes coverage of IAM,
  logging, monitoring, networking, CIS Levels 1 and 2, forensics, and even GDPR
  and HIPAA. Prowler also looks for resources that may or may not be
  intentionally configured in a way that violates the standards. For example,
  it will check for an open S3 bucket or a security group with an open port.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>S3
  Inspector</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>S3 Inspector is an open source tool used to check AWS S3 bucket
  permissions. The tool will check all account buckets for public access and
  provide a list of URLs that can be used to access that said public bucket. S3
  Inspector can be used as a normal CLI utility or as an AWS Lambda function.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>DNS
  Enumeration</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:black'>An OWASP Bay Area presentation in August 2019 covered the
  process of performing a port scan on an IP address found in the TXT records
  of a DNS enumeration process and revealed ssh keys that were used to log into
  servers hosted with AWS. These private keys were found in a zip file of an
  open S3 bucket. An RDS database server configuration file was found and username
  and password hashes were subsequently dumped. </span></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>S3_download_Bucket</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Publicly
  available Pacu module that scans the current account for AWS buckets and
  prints/stores as much data as it can about each one. With no arguments, this
  module will enumerate all buckets the account has access to, then prompt you
  to download all files in the bucket or not.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Mitigations</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=624
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Mitigation</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Use
  </span><span lang=EN-US><a href="https://attack.mitre.org/mitigations/M1037"><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:windowtext;
  text-decoration:none'>Network Traffic&nbsp;</span></a></span><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Policies</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create and apply AWS/Azure policies that restrict access to S3
  buckets or Azure Blobs from external networks.  In Azure you can restrict
  access to blobs to certain networks only during blob creation.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>An
  AWS environment can be configured with network ACLs (access control lists) to
  allow or deny inbound and outbound traffic. This can be accomplished by
  accessing Amazon VPC and navigating to either inbound or outbound rules
  depending on the rule the user wishes to add and they can be added, removed,
  or edited from that panel. Full details about ACLs and how to add rules in
  AWS can be found here: <b>https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>In
  Azure storage resources can be tied exclusively to a particular virtual
  network reducing the chances that it can be accessed externally or from other
  cloud assets. This can be done multiple ways including the Azure Portal,
  Azure PowerShell, and Azure CLI (Command Line Interface). Depending on the
  method used to implement this the procedure can vary, but will include the
  need to create a security group, create a network security group, associate
  that network security group with a specific subnet and then create security
  rules that are associated to the inbound and outbound rules for that subnet.
  Full details on how to configure this utilizing the various methods can be
  found below:</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  PowerShell: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic-powershell</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure
  CLI: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic-cli</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Audit&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Frequently check permissions on cloud storage to ensure proper
  permissions are set to deny open or unprivileged access to
  resources.&nbsp;Consider using automated resource checkers such
  as&nbsp;CloudSploit&nbsp;or&nbsp;Divvycloud&nbsp;.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via AWS it is suggested to review information such as
  account details (credentials, users, groups, roles, etc), mobile
  applications, EC2 configurations, policies, and account activity. How to
  audit these different factors can be found in detail at: <b>https://docs.aws.amazon.com/general/latest/gr/aws-security-audit-guide.html.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via Azure an administrator can review the audit logs that
  are recorded under Azure’s monitoring for active directory. The audit logs
  allow for filtering, as well as looking at users, groups, and enterprise
  specific information. Full details on how to access this information can be
  found at: <b>https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/concept-audit-logs.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>GCP</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  perform an audit via GCP the logs can be reviewed. GCP breaks this down into
  three categories; admin activity, data access, and system events. The audit
  logs can be viewed a few different ways- the console, API, or gcloud. Full
  details on how to view these logs, how to export, and for how to configure
  the retention period can be found here: <b>https://cloud.google.com/logging/docs/audit.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Don’t
  Do it</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='margin-right:.1in'><span lang=EN-US
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>Don’t
  store executable code within cloud storage repos.</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Encrypt
  Sensitive Information&nbsp;&nbsp;</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Encrypt data stored at rest in cloud storage. Managed
  encryption keys can be rotated by most providers. At a minimum, ensure an
  incident response plan to storage breach includes rotating the keys and test
  for impact on client applications.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  encrypt data at rest in an AWS environment first start by configuring the IAM
  roles and permissions. A policy will need to be created to specify that the
  data is to be encrypted and then the policy is attached to the instance. Full
  details on how to accomplish this can be found at: <b>https://aws.amazon.com/blogs/security/how-to-protect-data-at-rest-with-amazon-ec2-instance-store-encryption/</b>.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  encrypt data at rest in an Azure environment it can be done differently
  depending on the cloud service the customer is utilizing - normally a check
  box is presented enabling encryption for data at rest. For SaaS customers
  this can be enabled or available on each specific service. For PaaS customers
  there are specific storage and application platforms that are supported. In
  terms of IaaS customers Azure storage components such as queues and blobs are
  encrypted by selecting a check box during creation.  Azure also allows
  customers to employ their own encryption in addition to the server side
  encryption provided by Azure –effectively creating two layers of encryption
  for all  storage assets.  Currently this must be done programtically as
  described here: <b>https://docs.microsoft.com/en-us/azure/virtual-network/tutorial-filter-network-traffic</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'> Encrypted
  compute allows for all managed disks, snapshots, and images to be encrypted
  utilizing a service managed key. The keys are stored in the Azure key vault.
  Full details on how to accomplish this can be found at: <b><u>https://docs.microsoft.com/en-us/azure/security/fundamentals/encryption-atrest.</u></b></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Least
  Privilege </span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>All
  access given to users in the cloud environment should be assigned by the
  necessary privileges needed for team members to complete their job
  responsibilities.<span style='color:#222A35'> Ensure that temporary access
  tokens are issued rather than permanent credentials, especially when access
  is being granted to entities outside of the internal security boundary&nbsp;.</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Ensure
  only administrators have access to the S3 Permissions management actions.
  Grant actions like <i>List</i>, <i>Read</i>, and <i>Write</i> on a by-need
  basis, with particular attention on the <i>Write</i> action. Those with the <i>Write</i>
  action have the ability to delete or put objects into S3 buckets. To
  implement least privilege in an AWS environment IAM policies will be used.
  This gives the ability to allow users to perform list, read, write,
  permissions management, or tagging actions. AWS suggests utilizing <i>last
  accessed information</i> and A<i>WS CloudTrail event history</i> to get a
  better understanding of privileges that might be needed or reduced based on a
  specific role. Full details can be found at <b>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege.</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Disable
  anonymous access to blob containers with the following steps:</span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Go
  to <i>Storage Accounts</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>For
  each storage account, go to <i>Containers</i> under <i>BLOB SERVICE</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><i><span
  lang=EN-US style='font-size:9.0pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span></i><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>For
  each container, click <i>Access policy</i></span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Ensure
  <i>Public access level</i> is set to <i>Private</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Microsoft
  Blob Storage Security Recommendations</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Microsoft’s article contains recommendations for blob storage
  related to data protection, identity and access management, networking,
  logging, and monitoring. Azure Security Center is highly recommended to
  protect resources within Azure. It also provides recommendations on how to
  fix vulnerabilities.</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Full details for Microsoft’s security recommendations for blob
  storage can be found at </span><span lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/storage/blobs/security-recommendations"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>https://docs.microsoft.com/en-us/azure/storage/blobs/security-recommendations</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>.</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS
  S3 Security Best Practices</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Amazon’s article highlights best practices for S3 like
  ensuring S3 buckets are not publicly accessible, using IAM roles for
  applications services as related to S3, implementing encryption of data at
  rest, data in transit, and many others. </span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>Full details for AWS’s security best practices for S3 can be
  found at </span><span lang=EN-US><a
  href="https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#222A35'>.</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Multi-factor
  Authentication</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Use
  multi-factor authentication for user and privileged accounts. Do not manage
  Cloud portals from machines that perform user email and web browsing tasks.
  All users should be required to utilize two factor authentication.</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>This
  can be enforced by first creating a policy that would prohibit actions except
  those that allow a user to change their password or manage 2FA, then
  attaching a policy to a group that includes all user accounts where they can
  be allowed all access if they sign in with 2FA. Once these actions are
  completed it should be tested to verify the access is given correctly. To see
  full details on how to complete this view AWS documentation at: <b>https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_users-self-manage-mfa-and-creds.html.</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>This
  can be done by creating a MFA registration policy. It can than be assigned to
  all users (with the ability to exclude some if need be, but is not
  recommended). Make sure once the policy is created and added to users that it
  is then being enforced, once enforced it should be tested for verification.
  To see full details on how to complete this view Azure documentation at: <b>https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-configure-mfa-policy.</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>GCP</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>This
  can be done by first enabling it on the current account being used by admin
  to assign the roles, then enable two factor on an instance by instance or
  project by project basis, then assigning the requirements based on IAM roles
  and applying it to all users. To see full details on how to complete this
  view Azure documentation at: <b>https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication.</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:#222A35'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=312 colspan=2 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Restrict
  File and Directory Permissions</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Users
  should have limited access to files and directories depending on their need
  for access. The file and directory permissions should be restricted on the
  basis of least privilege.</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>AWS</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  manage the files and directory permissions in AWS, IAM policies can be used.
  This can be done by utilizing group policies and policy variables. The policy
  would be created specifying the folder, then the permissions attached to that
  folder (whether the user has access to list out the objects within the
  directory, if they have read permissions, if they have write permissions,
  etc.), lastly the group that it applies to would be specified. The users can
  that be added and removed from that group as needed. Full details on how this
  can be done is explained here: <b>https://aws.amazon.com/blogs/security/writing-iam-policies-grant-access-to-user-specific-folders-in-an-amazon-s3-bucket/.</b></span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>Azure</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>To
  manage the files and directory permissions in an Azure environment basic and
  advanced system defined controls. This will be dependent on the type of
  system being used (Windows, Linux, etc). The permissions will be set
  individually or by group using the system commands or controls needed.. Full
  details on how this can be done is explained here:<b> </b></span><span
  lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-ad-ds-configure-permissions"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif'>https://docs.microsoft.com/en-us/azure/storage/files/storage-files-identity-ad-ds-configure-permissions</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>.</span></b></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:16.0pt;font-family:"Arial",sans-serif'>Detection</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr style='height:15.0pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='line-height:107%'><b><span lang=EN-US
  style='font-family:"Arial",sans-serif'>Detection</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal><b><span lang=EN-US style='font-family:"Arial",sans-serif'>Description</span></b><span
  lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Enable
  S3 Bucket Logging</span></p>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>To enable CloudTrail S3 bucket logging:</span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Navigate to CloudTrail console at Go to the Amazon CloudTrail
  console </span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Click Trails in the API activity history pane on the left</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Sign into AWS Management Console and open the S3 console Sign in
  to the AWS Management Console and open the S3 console</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Click on a bucket under <i>All Buckets</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Click on <i>Properties</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Under <i>Bucket:_&lt;bucket_name&gt;_</i> click <i>Logging</i></span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Ensure <i>Enabled</i> is checked</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Create
  Log Metric Filters and Alarms for S3 </span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>To create a metric filter and alarm:</span></p>
  <p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create a filter that checks for S3 bucket policy changes and the
  specific<i> &lt;cloudtrail_log_group_name&gt;</i></span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an SNS topic that the alarm will notify</span></p>
  <p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an SNS subscription to the above topic</span></p>
  <p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
  lang=EN-US style='font-size:9.0pt;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>Create an alarm associated with the filter from step 1 and SNS
  topic in step 2</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=312 valign=top style='width:3.25in;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='line-height:107%'><span lang=EN-US
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>Enable
  Azure Storage Logging</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;
  color:black'>This is used to track how requests made to Azure Storage were
  authorized. Enabling logs provides visibility into whether a request was
  anonymous, made with an OAuth2.0 token, a shared key, or shared access
  signature (SAS). Full Azure Storage analytics logging details can be found at
  </span><span lang=EN-US><a
  href="https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet"><b><span
  style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet</span></b></a></span><b><span
  lang=EN-US style='font-size:9.0pt;font-family:"Arial",sans-serif;color:black'>.</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:18.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></p>

<p class=MsoNormal><a name=scite-1></a><span lang=EN-US style='font-size:16.0pt;
font-family:"Arial",sans-serif'>References</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span lang=EN-US>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>https://hackerone.com/reports/399166.
Accessed 02/12/2020</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif;color:black'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>techcommunity.microsoft.com/t5/azure-sentinel/hunting-for-capital-one-breach-ttps-in-aws-logs-using-azure/ba-p/1014258#.
Accessed Feb. 21, 2020</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a href="https://github.com/nccgroup/ScoutSuite"><span
style='font-family:"Arial",sans-serif;color:windowtext'>https://github.com/nccgroup/ScoutSuite</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 27, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a href="https://github.com/toniblyx/prowler"><span
style='font-family:"Arial",sans-serif;color:windowtext'>https://github.com/toniblyx/prowler</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 27, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://d0.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf"><span
style='font-family:"Arial",sans-serif'>https://d0.awsstatic.com/whitepapers/compliance/AWS_CIS_Foundations_Benchmark.pdf</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 27, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US style='font-family:"Arial",sans-serif'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://github.com/clario-tech/s3-inspector"><span style='font-family:
"Arial",sans-serif'>https://github.com/clario-tech/s3-inspector</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 27, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://blog.appsecco.com/getting-shell-and-data-access-in-aws-by-chaining-vulnerabilities-7630fa57c7ed"><span
style='font-family:"Arial",sans-serif'>https://blog.appsecco.com/getting-shell-and-data-access-in-aws-by-chaining-vulnerabilities-7630fa57c7ed</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 27, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"><span
style='font-family:"Arial",sans-serif'>https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed July 31, 2020. </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US><a
href="https://docs.microsoft.com/en-us/azure/storage/blobs/security-recommendations"><span
style='font-family:"Arial",sans-serif'>https://docs.microsoft.com/en-us/azure/storage/blobs/security-recommendations</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed August 3, 2020.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
lang=EN-US>10.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US><a
href="https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html"><span
style='font-family:"Arial",sans-serif'>https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed August 3, 2020.</span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span lang=EN-US>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US><a
href="https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet"><span
style='font-family:"Arial",sans-serif'>https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet</span></a></span><span
lang=EN-US style='font-family:"Arial",sans-serif'>. Accessed August 3, 2020. </span></p>

<p class=MsoNormal style='margin-left:.25in'><span lang=EN-US style='font-family:
"Arial",sans-serif'>&nbsp;</span></p>

</div>

</body>

</html>
